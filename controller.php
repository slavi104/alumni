<?php
include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fException.php';
include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fUnexpectedException.php';
include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fExpectedException.php';
include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fActiveRecord.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fAuthorization.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fAuthorizationException.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fBuffer.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fCRUD.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fCache.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fConnectivityException.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fCookie.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fCore.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fCryptography.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fDatabase.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fDate.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fDirectory.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fEmail.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fEmptySetException.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fEnvironmentException.php';  include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fFile.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fFilesystem.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fGrammar.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fHTML.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fImage.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fJSON.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fLoader.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fMailbox.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fMessaging.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fMoney.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fNoRemainingException.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fNoRowsException.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fNotFoundException.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fNumber.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fORM.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fORMColumn.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fORMDatabase.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fORMDate.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fORMFile.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fORMJSON.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fORMMoney.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fORMOrdering.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fORMRelated.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fORMSchema.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fORMValidation.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fPagination.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fProgrammerException.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fRecordSet.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fRequest.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fResult.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fSMTP.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fSQLException.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fSQLSchemaTranslation.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fSQLTranslation.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fSchema.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fSession.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fStatement.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fTemplating.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fText.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fTime.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fTimestamp.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fURL.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fUTF8.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fUnbufferedResult.php';  include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fUpload.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fValidation.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fValidationException.php'; include 'libs/flourishlib-flourish-classes-0.9.0-0-geb2d48b/flourish/fXML.php'; 

require 'config.php';
//fORMDatabase::attach(new fDatabase('mysql', 'ihriulr4_games_for_brains', 'ihriulr4', 'xYY!5eu5s:FQ'));
//fORMDatabase::attach(new fDatabase('mysql', 'db_alumni', 'root', ''));
fORMDatabase::attach(new fDatabase('mysql', 'cashtrac_alumni', SQL_USER, SQL_PASSWD));

class User extends fActiveRecord{


}

class Gameplay extends fActiveRecord{


}

class Article extends fActiveRecord{


}

class Test extends fActiveRecord{


}

class Game extends fActiveRecord{


}

class Functions {

public static function getLoggedPersonByEmail($email){
		try{
			$loggedUser = new User(array("email" => $email));
			$loggedUserId = $loggedUser->getId();
		} catch (fExpectedException $e) {
		    echo $e->printMessage();
		}
		return $loggedUser;
	}

public static function logout(){
    $id = fSession::get('current_user_id');
    try {
        
        $user = new User($id);
        $user->setIsActive(0);
        $user->store();

    } catch (Exception $e) {
        
    }
	fSession::destroy();
	header('Location: index.php');
}
public static function getLastArticle(){
    try
    {   
        $articles = fRecordSet::buildFromSQL('Article', 'SELECT articles.* FROM articles');
        
        foreach ($articles as $article) {
            $id=$article->getId();
        }

        $article = new Article(array("id" => $id));
        
    } catch (fExpectedException $e) 
    {
        echo $e->printMessage();
    }
    return $article;
}
public static function getUsers($is_teachers = 0){
    try
    {   

        $users = fRecordSet::buildFromSQL('User', 'SELECT users.* FROM users WHERE is_teacher = ' . $is_teachers);
        
    } catch (fExpectedException $e) 
    {
        echo $e->printMessage();
    }
    return $users;
}
public static function getUser($id){
    try
    {   
        $user = new User(array("id" => $id));
        
    } catch (fExpectedException $e) 
    {
        echo $e->printMessage();
    }
    return $user;
}
}

?>